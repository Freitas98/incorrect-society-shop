{% comment %}
  Price formatting snippet
  Input: amount (integer, cents)
  Output: Formatted price as a string (e.g., 12,34 €)
{% endcomment %}

{% liquid
  assign raw = amount | default: 0
  assign cents = raw | abs
  assign euros = cents | divided_by: 100
  assign cents_part = cents | modulo: 100

  # Two-digit cents string
  assign cents_str = cents_part | prepend: '00'
  assign cents_str = cents_str | slice: -2, 2

  # Thousands separator for euros
  assign s = euros | append: ''
  assign chars = s | split: '' | reverse
  assign grouped = ''
  for c in chars
    assign idx = forloop.index0
    assign mod = idx | modulo: 3
    if idx != 0 and mod == 0
      assign grouped = grouped | append: '.'
    endif
    assign grouped = grouped | append: c
  endfor
  assign euros_grouped = grouped | split: '' | reverse | join: ''
  assign formatted_price = euros_grouped | append: ',' | append: cents_str | append: ' €'

%}

{{ formatted_price }}
