<!doctype html>
<html lang="{{ request.locale.iso_code }}">
  <head>
    {% render 'css-variables' %}
    {{ 'critical.css' | asset_url | stylesheet_tag: preload: true }}
  {% render 'meta-tags' %}
  {{ content_for_header }}
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: var(--font-primary-family, sans-serif);
        color: #ffffff;
        background: #000000 url('https://cdn.shopify.com/s/files/1/0954/9840/4181/files/6.jpg?v=1764206051') center / cover no-repeat fixed;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        padding: 40px 20px;
      }

      .password-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 0;
      }

      .password-wrapper {
        position: relative;
        z-index: 1;
        width: min(520px, 100%);
        text-align: center;
        display: flex;
        flex-direction: column;
        gap: 32px;
        margin-top: 140px;
      }

      .password-logo {
        position: absolute;
        top: 32px;
        left: 50%;
        transform: translateX(-50%);
        width: min(220px, 60%);
        max-width: 240px;
        display: block;
        filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.45));
        z-index: 1;
      }

      .password-heading {
        margin: 0;
        font-size: clamp(2.6rem, 5vw, 3.6rem);
        letter-spacing: 0.18em;
        text-transform: uppercase;
      }

      .countdown {
        display: flex;
        justify-content: center;
        gap: 28px;
        text-transform: uppercase;
      }

      .countdown-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 72px;
      }

      .countdown-value {
        font-size: clamp(2.2rem, 8vw, 3.6rem);
        font-weight: 700;
        line-height: 1;
      }

      .countdown-label {
        font-size: 0.85rem;
        letter-spacing: 0.2em;
        margin-top: 10px;
        opacity: 0.8;
      }

      .password-form {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
      }

      .password-input-group {
        display: flex;
        width: 100%;
        max-width: 360px;
        border: 1px solid rgba(255, 255, 255, 0.7);
        border-radius: 999px;
        overflow: hidden;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(2px);
      }

      .password-input {
        flex: 1;
        padding: 14px 18px;
        background: transparent;
        border: none;
        color: #ffffff;
        font-size: 1rem;
        letter-spacing: 0.08em;
      }

      .password-input::placeholder {
        color: rgba(255, 255, 255, 0.55);
      }

      .password-input-group.button-only {
        border: none;
        background: transparent;
        max-width: unset;
        padding: 0;
        backdrop-filter: none;
        justify-content: center;
      }

      .password-input-group.button-only .password-input {
        display: none;
      }

      .password-arrow-btn {
        border: none;
        background: rgba(255, 255, 255, 0.15);
        color: #ffffff;
        font-size: 1.4rem;
        padding: 0 20px;
        cursor: pointer;
        transition: background 0.2s ease;
      }

      .password-arrow-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .password-input-group.button-only .password-arrow-btn {
        border: 1px solid rgba(255, 255, 255, 0.7);
        border-radius: 999px;
        padding: 12px 28px;
        background: rgba(0, 0, 0, 0.55);
      }

      .password-input-group.button-only .password-arrow-btn:hover {
        background: rgba(0, 0, 0, 0.75);
      }

      .password-caption {
        font-size: 0.9rem;
        letter-spacing: 0.18em;
        opacity: 0.8;
        text-transform: uppercase;
      }

      @media (max-width: 480px) {
        body {
          padding: 15px 40px 30px;
        }

        .password-wrapper {
          margin-top: 120px;
          gap: 24px;
        }

        .countdown {
          gap: 18px;
          flex-wrap: wrap;
          row-gap: 12px;
        }

        .password-logo {
          top: 24px;
          width: min(180px, 70%);
        }

        .password-input-group {
          max-width: 100%;
        }
      }
    </style>
    <meta name="google-site-verification" content="cQT3m4WAClIG7LVSb9jwTrsBaW3XHArBN_kgB6ZfcUg" />
  </head>
  <body>
    {% comment %} <div style="display: none;">{{ content_for_layout }}</div> {% endcomment %}
    <div class="password-overlay"></div>
    <img
      src="{{ 'logo.png' | asset_url }}"
      alt="{{ shop.name | escape }}"
      class="password-logo"
      loading="lazy"
      width="240"
      height="240"
    >
    <div class="password-wrapper">
      <h1 class="password-heading">THE BLACK FRIDAY SALE</h1>
      {% if settings.black_friday_countdown %}
        <div id="countdownContainer" class="countdown" role="timer" aria-live="polite">
          <div class="countdown-item">
            <span id="countdown-days" class="countdown-value">00</span>
            <span class="countdown-label">Days</span>
          </div>
          <div class="countdown-item">
            <span id="countdown-hours" class="countdown-value">00</span>
            <span class="countdown-label">Hours</span>
          </div>
          <div class="countdown-item">
            <span id="countdown-minutes" class="countdown-value">00</span>
            <span class="countdown-label">Minutes</span>
          </div>
          <div class="countdown-item">
            <span id="countdown-seconds" class="countdown-value">00</span>
            <span class="countdown-label">Seconds</span>
          </div>
        </div>
        {% form 'storefront_password', class: 'password-form' %}
          <div class="password-input-group" id="passwordInputGroup">
            <input
              class="password-input"
              name="password"
              type="password"
              autocomplete="current-password"
              placeholder="Enter password"
              required
              id="passwordInput"
            >
            <button type="submit" class="password-arrow-btn" aria-label="Submit password">
              ENTER
            </button>
          </div>
        {% endform %}
        <p class="password-caption">Sales start soon.</p>
      {% else %}
        <p class="password-caption">We are preparing something special.</p>
        {% form 'storefront_password', class: 'password-form' %}
          <div class="password-input-group">
            <input
              class="password-input"
              name="password"
              type="password"
              autocomplete="current-password"
              placeholder="Enter password"
              required
            >
            <button type="submit" class="password-arrow-btn" aria-label="Submit password">
              &gt;
            </button>
          </div>
        {% endform %}
      {% endif %}
    </div>
    {% if settings.black_friday_countdown %}
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          var preAccessDate = new Date('2025-11-27T02:02:00+00:00').getTime();
          var launchDate = new Date('2025-11-27T02:05:00+00:00').getTime();
          var countdownContainer = document.getElementById('countdownContainer');
          var daysEl = document.getElementById('countdown-days');
          var hoursEl = document.getElementById('countdown-hours');
          var minutesEl = document.getElementById('countdown-minutes');
          var secondsEl = document.getElementById('countdown-seconds');
          var inputGroup = document.getElementById('passwordInputGroup');
          var passwordInput = document.getElementById('passwordInput');
          var arrowButton = inputGroup ? inputGroup.querySelector('.password-arrow-btn') : null;
          var captionEl = document.querySelector('.password-caption');
          var countdownInterval = null;
          var lastState = null;

          function pad(value) {
            return value.toString().padStart(2, '0');
          }

          function setRequired(input, isRequired) {
            if (!input) {
              return;
            }
            if (isRequired) {
              input.required = true;
            } else {
              input.required = false;
              input.removeAttribute('required');
            }
          }

          function applyState(now) {
            if (!passwordInput || !inputGroup) {
              return null;
            }

            var state;
            if (now < preAccessDate) {
              state = 'pre';
            } else if (now >= preAccessDate && now < launchDate) {
              state = 'access';
            } else {
              state = 'live';
            }

            if (state === lastState) {
              return state;
            }

            if (state === 'pre') {
              inputGroup.classList.add('button-only');
              passwordInput.type = 'hidden';
              passwordInput.value = 'BeforeFriday.2025';
              passwordInput.placeholder = '';
              setRequired(passwordInput, false);
              if (arrowButton) {
                arrowButton.setAttribute('aria-label', 'Enter store');
              }
              if (captionEl) {
                captionEl.textContent = 'Sales start soon.';
              }
              if (countdownContainer) {
                countdownContainer.style.display = 'flex';
              }
            } else if (state === 'access') {
              inputGroup.classList.remove('button-only');
              passwordInput.type = 'password';
              passwordInput.value = '';
              passwordInput.placeholder = 'Enter password';
              setRequired(passwordInput, true);
              if (arrowButton) {
                arrowButton.setAttribute('aria-label', 'Submit password');
              }
              if (captionEl) {
                captionEl.textContent = 'Enter the password to unlock early access.';
              }
              if (countdownContainer) {
                countdownContainer.style.display = 'flex';
              }
            } else {
              inputGroup.classList.add('button-only');
              passwordInput.type = 'hidden';
              passwordInput.value = 'IncorrectFriday.2025';
              passwordInput.placeholder = '';
              setRequired(passwordInput, false);
              if (arrowButton) {
                arrowButton.setAttribute('aria-label', 'Enter store');
              }
              if (captionEl) {
                captionEl.textContent = 'Black Friday is live! Tap to enter.';
              }
              if (countdownContainer) {
                countdownContainer.style.display = 'none';
              }
            }

            lastState = state;
            return state;
          }

          function updateCountdown() {
            var now = Date.now();
            var state = applyState(now);
            var timeLeft = launchDate - now;

            if (state === 'live') {
              if (countdownInterval) {
                clearInterval(countdownInterval);
              }
              return;
            }

            if (timeLeft <= 0) {
              if (countdownInterval) {
                clearInterval(countdownInterval);
              }
              applyState(launchDate);
              if (daysEl) {
                daysEl.textContent = '00';
              }
              if (hoursEl) {
                hoursEl.textContent = '00';
              }
              if (minutesEl) {
                minutesEl.textContent = '00';
              }
              if (secondsEl) {
                secondsEl.textContent = '00';
              }
              return;
            }

            var days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            var hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

            if (daysEl) {
              daysEl.textContent = pad(days);
            }
            if (hoursEl) {
              hoursEl.textContent = pad(hours);
            }
            if (minutesEl) {
              minutesEl.textContent = pad(minutes);
            }
            if (secondsEl) {
              secondsEl.textContent = pad(seconds);
            }
          }

          applyState(Date.now());
          updateCountdown();
          countdownInterval = setInterval(updateCountdown, 1000);
        });
      </script>
    {% endif %}
  </body>
</html>
